if(window.RUNTIME_LOC==undefined){var RUNTIME_LOC="local/web"}if(window.MOBILE==undefined){var MOBILE=false}var DESTROY_TWEETS=true;var TWEET_DISPLAY_LIMIT=20;var LOCATION_SEARCH_DISTANCE="5mi";var UPDATE_LOCATION=false;var UPDATE_FREQ=45000;var AUTO_UPDATE=true;var URL_BASE="";var BIND_CLICKS=false;var XS=false;var AIR=false;var PROXY=true;var CSS_FILE="front/newui.css";var FONT_SIZE=100;var TABBED_PANELS=false;var PANEL_WIDTH=500;var ADD_HASHTAG=false;var shizzow_data=null;if(RUNTIME_LOC=="air"){BIND_CLICKS=true;URL_BASE="http://twitter.tagal.us/";XS=true;AIR=true;PROXY=false}if(window.mt_options){mt_options()}function update_settings(){if(parseInt($("#refresh_freq").val())!=NaN){UPDATE_FREQ=parseInt($("#refresh_freq").val())*1000}DESTROY_TWEETS=$("#remove_old_tweets").attr("checked");ADD_HASHTAG=$("#add_hashtag").attr("checked");if(ADD_HASHTAG){$(".add_hashtag").css("display","normal");$(".add_hashtag").show()}else{$(".add_hashtag").css("display","hidden");$(".add_hashtag").hide()}FONT_SIZE=parseInt($("#font_size").val());$("#panels").css("font-size",FONT_SIZE+"%");PANEL_WIDTH=parseInt($("#panel_width").val());if(PANEL_WIDTH<400){PANEL_WIDTH=400}update_widths();if(TABBED_PANELS!=$("#tabbed_panels").attr("checked")){TABBED_PANELS=$("#tabbed_panels").attr("checked");refresh_window()}save_settings_in_cookie();show_settings_form()}function save_settings_in_cookie(){var a="";a+="UPDATE_FREQ="+UPDATE_FREQ;a+="&";a+="TABBED_PANELS="+TABBED_PANELS;a+="&";a+="FONT_SIZE="+FONT_SIZE;a+="&";a+="DESTROY_TWEETS="+DESTROY_TWEETS;a+="&";a+="PANEL_WIDTH="+PANEL_WIDTH;a+="&";a+="ADD_HASHTAG="+ADD_HASHTAG;$.cookie("combotweet_settings",a)}function get_settings_in_cookie(){var a=$.cookie("combotweet_settings");if(a==null){return}settings_array=a.split("&");for(i in settings_array){var b=settings_array[i].split("=");if(b[0]=="UPDATE_FREQ"){UPDATE_FREQ=parseInt(b[1])}else{if(b[0]=="FONT_SIZE"){FONT_SIZE=parseInt(b[1]);$("#panels").css("font-size",""+FONT_SIZE+"%")}else{if(b[0]=="PANEL_WIDTH"){PANEL_WIDTH=parseInt(b[1]);update_widths()}else{if(b[0]=="DESTROY_TWEETS"){if(b[1]=="false"){DESTROY_TWEETS=false}else{DESTROY_TWEETS=true}}else{if(b[0]=="ADD_HASHTAG"){if(b[1]=="false"){ADD_HASHTAG=false}else{ADD_HASHTAG=true}$(".add_hashtag").css("display","normal")}else{if(b[0]=="TABBED_PANELS"){if(b[1]=="false"){TABBED_PANELS=false}else{TABBED_PANELS=true;$("#header_nav_buttons").css("display","normal");$("#header_nav_buttons").show()}}}}}}}}}var selected_tweet=-1;var selected_tweet_panel=0;var tw_panels=new Array();var front_panel=null;var user_loc="";var plugin_hooks=new Array();function Data_Panel(b,c,d,a,e){this.panel_id=b;this.panel_type=c;this.user=d;this.pass=a;this.gen_info=e;this.selected_tweet=null;this.auth=make_base_auth(d,a);this.latest_tweet_id="-1";this.tweet_type=null;this.panel_data=new Array();this.reply_id=-1;this.reply_to_name=null;this.tweet_display_limit=TWEET_DISPLAY_LIMIT}function CT_Plugin(a,b){this.hook=a;this.callback=b}$(document).ready(function(){if(!AIR){doc_ready_functions()}});function doc_ready_functions(){get_settings_in_cookie();get_session_panels();if(window.request_panes!=undefined){for(i in request_panes){add_search_panel(request_panes[i])}request_panes=undefined}if(AUTO_UPDATE){auto_update_tweets()}bind_shortcuts()}function bind_shortcuts(){shortcut.add("up",function(){goto_previous_tweet()});shortcut.add("down",function(){goto_next_tweet()});shortcut.add("left",function(){goto_previous_panel();return false});shortcut.add("right",function(){goto_next_panel();return false})}function parse_last_update(a,b){$("#panel_"+a).find(".last_update").html(b[0].text)}function parse_get_shouts_data(b,a,e){shizzow_data=e;hide_loader();var f=new Date();for(i in e.results.shouts){var c="";var d=e.results.shouts[i];var h=d.shouts_history_id;c+='<div class="tweet" id="shout_'+h+'">';c+='<div class="avatar_container"><img class="avatar" src="'+e.results.shouts[i].people_images.people_image_48+'" alt="Avatar"/></div>';c+='<div class="the_tweet">';var l="";if(d.shouts_messages!=null){l=d.shouts_messages[0].message}c+=d.people_name+" shouted from "+d.places_name;if(l!=""){c+='<span class="tweet_text">'+l+"</span>"}c+='<span class="tweet_meta">';var g=new Date();g.setISO8601(d.arrived);c+='<span id="tweet_time_'+h+'">'+d.shout_time+"</span>";c+="</div>";c+='<br class="clear_both"/>';c+="</div>";$("#panel_"+b).find(".tweets").append(c);$("#panel_"+b).find("#shout_"+h).show()}}function parse_get_tweets_data(f,d,r,y){if(d=="direct_sent"){d="direct"}var u=$("#panel_"+f).find(".tweets");var t=get_panel_by_id(f);if(t.panel_data==y){update_times(f);return}if(t.panel_type=="shizzow_panel"){parse_get_shouts_data(f,r,y);return}var m=new Date();var g=false;if(y.results!=undefined){g=true}if(r==1){if(!g){y.reverse()}else{y.results.reverse()}}var v=y.length;if(g){v=y.results.length}for(i=0;i<v;i++){var a=null;if(!g){a=y[i]}else{a=y.results[i]}var b=false;if(t.tweet_type=="replies"){if((""+a.from_user)==(t.user+"")){b=true}}for(j=0;j<t.panel_data.length;j++){if(t.panel_data[j].text==a.text){b=true}}if(b){continue}if(a.id>t.latest_tweet_id){t.latest_tweet_id=a.id}t.panel_data.push(a);if(DESTROY_TWEETS){if(t.panel_data.length>t.tweet_display_limit){var q=t.panel_data.shift();$("#panel_"+f+"tweet_"+q.id).hide();$("#panel_"+f+"tweet_"+q.id).remove()}}var z="";if(a.favorited){z="favorite_tweet"}var l='<div class="'+a.id+" tweet "+z+'" id="panel_'+f+"tweet_"+a.id+'">';l+='<div class="tweet_top"></div>';l+='<div class="tweet_left"></div>';var e="";if(!g){if(d!="direct"){e=a.user.profile_image_url}else{e=a.sender.profile_image_url}}else{e=a.profile_image_url}l+='<div class="avatar_container"><img class="avatar" src="'+e+'" alt="Avatar"/></div>';l+='<div class="the_tweet">';l+='<div class="the_tweet_top"></div>';l+='<div class="the_tweet_left"></div>';var o="";if(!g){if(d=="direct"){o=a.sender_screen_name}else{o=a.user.screen_name}}else{o=a.from_user}l+='<input type="hidden" class="tweet_user_name" value="'+o+'"/>';l+='<input type="hidden" class="tweet_id" value="'+a.id+'"/>';l+='<a class="user_name" onclick="return display_twitter_user(\''+o+'\');" href="">'+o+"</a>: ";var p=parse_tweet(a.text);l+='<span class="tweet_text">'+p+"</span>";l+='<span class="tweet_meta">';var n=new Date(a.created_at);l+='<span id="tweet_time_'+a.id+'">'+get_time_text(m,n)+"</span>";if(a.in_reply_to_screen_name!=undefined){l+='In reply to <a href="http://twitter.com/'+a.in_reply_to_screen_name+'">'+a.in_reply_to_screen_name+"</a> "}if(!g){if(d!="direct"){l+="from "+a.source}}l+="</span>";var h=true;if(g){h=false}if(d=="replies"){h=true}if(o==(""+t.user)){h=false}var w=true;if(d=="direct"){w=false}if(g){w=false}l+='<div class="tweet_buttons">';if(d!="direct"){if(!g){l+='<div id="retweet_'+a.id+'" class="retweet_icon" ';l+="onclick=\"retweet_button('"+f+"',"+a.id+",'"+o+"')\">";l+='<img src="'+URL_BASE+'images/Recycle.png" alt="Retweet" title="Retweet" /></div>'}}if(w){l+='<div id="favorite_'+a.id+'" class="favorite_icon" ';l+="onclick=\"toggle_favorite('"+f+"',"+a.id+')">';l+='<img src="'+URL_BASE+'images/star.gif" alt="Favorite" title="Favorite this tweet" /></div>'}if(h){l+='<div id="reply_'+a.id+'" class="reply_icon" ';l+="onclick=\"reply_to_tweet('"+f+"',"+a.id+",'"+o+"')\">";l+='<img src="'+URL_BASE+'images/reply.gif" alt="Reply to this tweet" /></div>'}l+="</div>";l+='<div class="the_tweet_right"></div>';l+='<div class="the_tweet_bottom"></div>';l+="</div>";l+='<br class="clear_both"/>';l+='<div class="tweet_right"></div>';l+='<div class="tweet_bottom"></div>';l+="</div>";if(r==1){u.prepend(l)}else{u.append(l)}var c=""+f;var s=""+a.id;var x=""+o;$("#panel_"+f+"tweet_"+a.id).show()}hide_loader();save_panel(f,t);update_times(f);$(".tweet").click(function(){$(".tweet:eq("+selected_tweet+")").removeClass("selected_tweet");selected_tweet_panel_id=$(this).parent().parent()[0].id;selected_tweet=$("#"+selected_tweet_panel_id+" div.tweet").index(this);for(i in tw_panels){if(("panel_"+tw_panels[i].panel_id)==selected_tweet_panel_id){selected_tweet_panel=i}}$(this).addClass("selected_tweet")});update_widths()}function parse_tweet(d){var c=d;var b=/(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]/gi;c=d.replace(b,'<a target="_blank" class="tweeted_link" href="$&" onclick="return follow_link(\'$&\')">$&</a>');var e=/[#]+[A-Za-z0-9-_]+/gi;c=c.replace(e,function(g){var f=g.replace("#","");return'<a target="_blank" href="http://tagal.us/tag/'+f+'" onclick="return follow_link(\'http://tagal.us/tag/'+f+"');\">"+g+"</a>"});var a=/[@]+[A-Za-z0-9-_]+/gi;c=c.replace(a,function(f){var g=f.replace("@","");return'<a href="http://twitter.com/'+g+'" onclick="return display_twitter_user(\''+g+"');\">"+f+"</a>"});return c}function parse_shizzow_favorites(a,b){shizzow_data=b;for(i in b.results.places){var c=b.results.places[i];$("#panel_"+a).find(".shizzow_favorites").append('<option value="'+c.places_key+'">'+c.places_name+"</option>")}}function get_panel_by_id(a){for(pan in tw_panels){if(tw_panels[pan].panel_id==a){return tw_panels[pan]}}return null}function save_panel(a,b){for(panel in tw_panels){if(panel.panel_id==a){panel=b}}if(AIR){air_save_panels()}}function get_session_panels(){if(AIR){air_get_session_panels();return}if(PROXY){proxy_get_session_panels();return}}function add_new_nav_button(b){var d=get_panel_user_name(b);var a='<img src="'+URL_BASE+'images/Cancel.png" id="remove_panel_'+b+'"  class="close_panel" onclick="remove_panel(\''+b+'\')" alt="Close Panel" title="Close this panel" />';var c='<div class="nav_button show_panel_'+b+'" onclick="show_panel(\''+b+"')\">"+d+a+"</div>";$("#header_nav_buttons").append(c);$("#panel_"+b).prepend(c);if(!AIR){$("#panels").sortable({handle:".nav_button",update:function(){},})}}function make_new_panel(){var d=$("#tw_user").val();var g=$("#tw_pass").val();$("#login_form").hide("slide",{direction:"up"},600);$("#tw_user").val("");$("#tw_pass").val("");if($("#account_type").val()=="shizzow"){make_new_shizzow_panel(d,g);return}var b=d;if(get_panel_by_id(b)!=null){alert("You already have that panel open!");return}var c=true;if(PROXY){c=proxy_check_login(d,g)}if(XS){c=js_check_login(d,g)}if(!c){alert("That login user/pass didn't work!");return}var e=null;if(XS){e=js_get_twitter_user_info(d)}else{e=proxy_get_twitter_user_info(d)}var h=new Data_Panel(b,"regular_panel",d,g,e);tw_panels.push(h);if(AIR){air_save_panels()}if(!AIR){var f=proxy_get_panel(b,d,g,e)}var a=js_get_panel(b,d,g,e);set_up_panel(b,a,d,g)}function remove_panel(a){$("#panel_"+a).remove();if(!TABBED_PANELS){$("#panels").width($("#panels").width()-(PANEL_WIDTH-20))}else{$(".show_panel_"+a).remove()}$("#show_panel_"+a).remove();for(i=0;i<tw_panels.length;i++){if(tw_panels[i].panel_id==a){tw_panels.splice(i,1)}}if(PROXY){proxy_remove_panel(a)}if(AIR){air_remove_panel(a)}front_panel=tw_panels[0].panel_id;show_panel(front_panel)}function add_search_panel(e){if(e==null){e=prompt_search_term()}if((e=="")||(e==null)){return}var a="Search "+e;var g=new Date();a="Search_"+g.getTime();if(get_panel_by_id(a)!=null){alert("You already have a panel open like that!");return}var f=new Data_Panel(a,"search_panel",e,"_search",null);tw_panels.push(f);if(AIR){air_save_panels()}var c=js_get_search_panel(a,e,"_search");if(PROXY){var b=proxy_get_search_panel(a,e,"_search")}set_up_panel(a,c,e,"_search");return false}function set_up_panel(d,c,b,a){$("#panels").append(c);if(!TABBED_PANELS){$("#panels").width($("#panels").width()+(PANEL_WIDTH+20))}add_new_nav_button(d);show_panel(d);get_tweets(d,"regular",1)}function show_panel(a){if(a==undefined){return}var c=get_panel_by_id(a);if(c==null){return}front_panel=a;if(TABBED_PANELS){$(".twitter_panel").hide();$("div#header_nav_buttons div.nav_button").removeClass("button_highlighted");$("div#header_nav_buttons div.show_panel_"+a).addClass("button_highlighted")}$("#panel_"+a).show();if(c.tweet_type==null){c.tweet_type="regular";save_panel(a,c)}$("#panel_"+a+"_"+c.tweet_type).show();$("#panel_"+a+"_"+c.tweet_type).addClass("button_highlighted");$("#panel_"+a).find(".tweet_input").keyup(function(){length_notify(a)});if(TABBED_PANELS){var b=$("#panel_"+a).find(".panel_background").val();if(!MOBILE){}}}function get_panel_user_name(a){if(a.indexOf("Search_")!=-1){return"Search: "+$("#panel_"+a).find(".panel_user_name").val()}if(a.indexOf("Shizzow_")!=-1){return"Shizzow: "+$("#panel_"+a).find(".panel_user_name").val()}return a}function register_plugin(b,c){var a=new CT_Plugin(b,c);plugin_hooks.push(a)}function get_plugins(a){}function run_plugins(hook,args){for(i=0;i<plugin_hooks.length;i++){if(plugin_hooks[i].hook==hook){eval(plugin_hooks.callback_fn)}}}function send_shout(b){var d=get_panel_by_id(b);var c=$("#panel_"+b).find(".tweet_input").val();var a=$("#panel_"+b).find(".shizzow_favorites").val();$("#panel_"+b).find(".tweet_input").val("");$("#panel_"+b).find(".length_notify_box").html("");if(PROXY){proxy_send_shout(b,c,a)}}function make_new_shizzow_panel(c,g){var l=new Date();var b="Shizzow_"+l.getTime();if(get_panel_by_id(b)!=null){alert("You already have a panel open like that!");return}if(PROXY){var f=proxy_get_shizzow_panel(b,c,g)}var e="";var h=new Data_Panel(b,"shizzow_panel",c,g,e);h.tweet_type="shouts";tw_panels.push(h);var a=js_get_shizzow_panel(b,c,g);set_up_panel(b,a,c,g);if(PROXY){proxy_get_shizzow_favorites(b)}}function update_times(a){var c=get_panel_by_id(a);cur_date=new Date();if(c.panel_data!=undefined){for(var b=0;b<c.panel_data.length;b++){$("#tweet_time_"+c.panel_data[b].id).html(get_time_text(cur_date,new Date(c.panel_data[b].created_at)))}}}function get_time_text(d,b){var e=parseInt((d.getTime()-b.getTime())/1000);if(e<=(60*60*12)){if(e<=60){return"Less than a minute ago "}else{if(e<3600){var a=parseInt(e/60);return a+" minutes ago "}else{var c=parseInt(e/3600);return c+" hours ago "}}}else{return b+" "}}function get_tweets(a,c,b){if(a==null){return}var f=get_panel_by_id(a);show_loader();var e=$("#panel_"+a).find(".tweets");if(c==undefined){c="regular"}if(c!="direct"){$("#panel_"+a).find(".dm_notify_box").hide()}else{$("#panel_"+a).find(".dm_notify_box").show()}var d=false;if(f.panel_data==null){f.panel_data=new Array();d=true}if(f.tweet_type==null){f.tweet_type=c}if(f.tweet_type!=c){e.html("");f.tweet_type=c;f.panel_data=new Array();f.latest_tweet_id=-1;if((f.tweet_type=="direct")||(f.tweet_type=="direct_sent")){if($(".direct_options").length==0){$("#panel_"+a).find(".tweet_type_menu").append('<div class="direct_options"><a href="" onclick="get_tweets(\''+a+"','direct',1); return false;\">Inbox</a><a href=\"\" onclick=\"get_tweets('"+a+"','direct_sent',1); return false;\">Outbox</a><br class=\"clear_both\"></div>")}}else{$(".direct_options").remove()}}save_panel(a,f);if(PROXY){proxy_get_tweets(a,c,b,f.latest_tweet_id,user_loc,LOCATION_SEARCH_DISTANCE)}if(XS){js_get_tweets(a,c,b,f.latest_tweet_id,user_loc,LOCATION_SEARCH_DISTANCE)}if(c=="direct_sent"){c="direct"}$("#panel_"+a).find(".tweet_type_button").removeClass("button_highlighted");$("#panel_"+a).find("#panel_"+a+"_"+c).addClass("button_highlighted")}function get_more_tweets(a){var e=get_panel_by_id(a);if(DESTROY_TWEETS){e.tweet_display_limit+=20;save_panel(e)}var c=e.panel_data.length;if((c%20)!=0){c++}var b=Math.ceil(c/20)+1;var d="regular";if(e.tweet_type!=null){d=e.tweet_type}get_tweets(a,d,b)}function send_tweet(b){var f=$("#panel_"+b).find(".tweet_input").val();if(ADD_HASHTAG){var d=$("#panel_"+b).find("input.add_hashtag").val();if(d!=""){if(d.charAt(0)!="#"){d="#"+d}f+=" "+d}}var e=get_panel_by_id(b);if(e.reply_to_name!=null){if(f.indexOf("@"+e.reply_to_name)==-1){e.reply_id=-1}}else{e.reply_to_name=null}save_panel(e);var c=e.reply_to_id;if(f.length>140){alert("Too many characters: "+f.length);return}$("#panel_"+b).find(".tweet_input").val("");$("#panel_"+b).find(".length_notify_box").html("");$("#panel_"+b).find(".last_update").val(f);var a=false;if(e.tweet_type=="direct"){a=true;$("#panel_"+b).find(".dm_notify_box").html("")}if(PROXY){proxy_send_tweet(b,f,c,e.reply_to_name,a)}if(XS){js_send_tweet(b,f,c,e.reply_to_name,a)}e.reply_to_id=-1;e.reply_to_name=null;save_panel(e)}function reply_to_tweet(a,b,d){var e=get_panel_by_id(a);e.reply_id=b;e.reply_to_name=d;save_panel(e);var c=$("#panel_"+a).find(".tweet_input");c.focus();$.scrollTo($("#panel_"+a+""),20,{offset:{left:0,top:-110}});if(e.tweet_type=="direct"){$("#panel_"+a).find(".dm_notify_box").html("Direct message to @"+d)}else{c.val("@"+d+" ")}}function reply_button(a,d){var b=$(d).parent(".the_tweet").find(".tweet_id").val();var c=$(d).parent(".the_tweet").find(".tweet_user_name").val();reply_to_tweet(a,b,c)}function retweet_button(b,c,e){var a=$("#panel_"+b+"tweet_"+c).find(".tweet_text").text();var d="RT @"+e+": "+a;if(d.length>140){d=d.substring(0,137)+".."}$("#panel_"+b).find(".tweet_input").val(d)}function toggle_favorite(b,c){var a=$("#panel_"+b+"tweet_"+c).hasClass("favorite_tweet");if(a){$("#panel_"+b+"tweet_"+c).removeClass("favorite_tweet")}else{$("#panel_"+b+"tweet_"+c).addClass("favorite_tweet")}if(PROXY){proxy_toggle_favorite(b,c,!a)}if(XS){js_toggle_favorite(b,c,!a)}}function toggle_favorite_button(a,c){var b=$(c).parent(".the_tweet").find(".tweet_id").val();toggle_favorite(a,b)}function auto_update_tweets(){if(AIR){setTimeout(function(){auto_update_tweets()},UPDATE_FREQ)}else{setTimeout("auto_update_tweets()",UPDATE_FREQ)}for(i in tw_panels){if(tw_panels[i].panel_type!="shizzow_panel"){get_tweets(tw_panels[i].panel_id,tw_panels[i].tweet_type,1)}}}function refresh_tweets(){$("#panels").find(".panel_id").each(function(a){get_tweets(this.value,"regular",1)})}function get_user_tweets(b,a){$(".get_user_tweets").hide();if(XS){js_get_user_tweets(a,$(b).parent())}if(PROXY){proxy_get_user_tweets(a,$(b).parent())}}function follow_user(a,b){if(PROXY){proxy_follow_user(a,b)}if(XS){js_follow_user(a,b)}}function goto_previous_tweet(){scroll_to_tweet(selected_tweet_panel,selected_tweet-1)}function goto_next_tweet(){scroll_to_tweet(selected_tweet_panel,selected_tweet+1)}function goto_previous_panel(){scroll_to_tweet(selected_tweet_panel-1,selected_tweet)}function goto_next_panel(){scroll_to_tweet(selected_tweet_panel+1,selected_tweet)}function scroll_to_tweet(b,a){if(tw_panels.length==0){return}var c=tw_panels[selected_tweet_panel].panel_id;$(".tweet").removeClass("selected_tweet");if(b!=selected_tweet_panel){if((b>-1)&&(b<tw_panels.length)){if(a>=tw_panels[b].panel_data.length){a=tw_panels[b].panel_data.length-1}selected_tweet_panel=b}}if(a==-2){if(selected_tweet_panel==0){a=-1}else{selected_tweet_panel=selected_tweet_panel-1;c=tw_panels[selected_tweet_panel].panel_id;a=tw_panels[selected_tweet_panel].panel_data.length-1}}if(a>=tw_panels[selected_tweet_panel].panel_data.length){if(selected_tweet_panel<(tw_panels.length-1)){selected_tweet_panel++;c=tw_panels[selected_tweet_panel].panel_id;a=-1}else{a=tw_panels[selected_tweet_panel].panel_data.length-1}}if(a!=-1){$.scrollTo($("#panel_"+c+" div.tweet:eq("+a+")"),400,{offset:{left:0,top:-90}});$("#panel_"+c+" div.tweet:eq("+a+")").addClass("selected_tweet")}else{$.scrollTo($("#panel_"+c+""),400,{offset:{left:0,top:-110}})}selected_tweet=a}function show_login_form(){$("#login_form").css("left",$(window).width()-420);$("#login_form").toggle("slide",{direction:"up"},400,function(){$("#login_form:visible").find("#tw_user").focus()})}function show_settings_form(){$("#settings_form").css("left",$(window).width()-600);$("#settings_form").toggle("slide",{direction:"up"},400,function(){$("#tabbed_panels").attr("checked",TABBED_PANELS);$("#add_hashtag").attr("checked",ADD_HASHTAG);$("#refresh_freq").val(""+(UPDATE_FREQ/1000));$("#remove_old_tweets").attr("checked",DESTROY_TWEETS);$("#font_size").val(""+FONT_SIZE);$("#panel_width").val(""+PANEL_WIDTH)})}function prompt_search_term(){var b="Enter a search term:";var a=prompt(b);return a}function follow_link(a){if(AIR){window.parentSandboxBridge.nav_in_browser(a);return false}return true}function show_notify_window(a){$("#notify_overlay").css("opacity","0.5");$("#notify_overlay").css("height",$(document).height());$("#notify_overlay").show();$("#notify_window").css("left",($(window).width()/2)-200);$("#notify_window").css("top",$(window).scrollTop()+50);$("#notify_window").css("opacity","1");$("#notify_content").html(a);$("#notify_window").show()}function hide_notify_window(){$("#notify_overlay").hide();$("#notify_content").html("");$("#notify_window").hide()}function display_twitter_user(d){var a=true;var c="";if(PROXY){c=proxy_get_twitter_user_info(d)}if(XS){c=js_get_twitter_user_info(d)}var b="";b+='<span class="user_name"><a target="_blank" href="http://twitter.com/'+d+'" onclick="return follow_link(\'http://twitter.com/'+d+"')\">@"+d+"</a>";if(a){b+=' - <a href="" onclick="follow_user_window(\''+d+"'); return false;\">Follow</a>"}b+="</span>";b+='<img class="avatar" src="'+c.profile_image_url+'" alt="Avatar" title="'+d+'"/>';b+='<p class="user_info">'+parse_tweet(c.description)+"</p>";if(c.url!=null){b+='<span class="user_url"><a target="_blank" href="'+c.url+'" onclick="return follow_link(\''+c.url+"')\">"+c.url+"</a></span>"}b+='<div class="user_stats">';b+="<label>Followers:</label>"+c.followers_count+"<br/>";b+="<label>Following:</label>"+c.friends_count+"<br/>";b+="</div>";b+='<div class="user_tweets">';b+='<a href="" class="get_user_tweets" onclick="get_user_tweets(this,\''+d+"'); return false;\">Get tweets</a>";b+="</div>";show_notify_window(b);return false}function display_user_tweets(b,a){var c="<ul>";for(i=0;i<b.length;i++){c+="<li>"+parse_tweet(b[i].text)+"</li>"}c+="</ul>";a.append(c)}function follow_user_window(c){var b=new Array();for(i in tw_panels){if(tw_panels[i].panel_type!="search_panel"){b.push(tw_panels[i])}}if(b.length<1){alert("I'm sorry, but you aren't logged in to any Twitter accounts, so you can't follow that user");return}var a="";a+="<h3>Follow @"+c+"</h3>";for(i in b){a+='<a href="" onclick="follow_user(\''+b[i].panel_id+"','"+c+"'); return false;\">Follow with "+b[i].panel_id+" account</a>";a+="<br/>"}show_notify_window(a)}function update_widths(){$("div.panel").width(PANEL_WIDTH);$("div.the_tweet").width(PANEL_WIDTH-110);if(!TABBED_PANELS){$("#panels").width((PANEL_WIDTH+20)*tw_panels.length)}}function refresh_window(){var a=window.location.href;window.location.href=a}function logout(){if(AIR){air_destroy_db();refresh_window()}if(PROXY){$.post(URL_BASE+"bin/ajax.php",{func:"logout",},function(a){refresh_window()},"html")}}function show_loader(){$("#loader").show()}function hide_loader(){$("#loader").hide()}function length_notify(b){var d=$("#panel_"+b).find(".tweet_input");var c=d.val().length;if(ADD_HASHTAG){c+=$("#panel_"+b).find("input.add_hashtag").val().length}if(c>=140){d.val(d.val().substring(0,140));c=max_length}var a="";if(c>=120){a='<span style="color: red;">'}else{a="<span>"}if(c==0){$("#panel_"+b).find(".length_notify_box").html("")}else{$("#panel_"+b).find(".length_notify_box").html(a+(140-c)+" characters left</span>")}}function air_remove_panel(a){window.parentSandboxBridge.air_remove_panel()}function air_save_panels(){window.parentSandboxBridge.air_save_panels(tw_panels)}function air_get_session_panels(){var stored_v=window.parentSandboxBridge.air_get_session_panels();var saved_panels=eval("("+stored_v+")");if(saved_panels==undefined){return}for(i=0;i<100;i++){if(saved_panels[""+i]==undefined){return}var pan=saved_panels[""+i];pan.latest_tweet_id="-1";pan.panel_data=new Array();tw_panels.push(pan);var pan_html=js_get_panel(pan.panel_id,pan.user,pan.pass,pan.gen_info);set_up_panel(pan.panel_id,pan_html,pan.user,pan.pass)}}function air_destroy_db(){window.parentSandboxBridge.air_destroy_db()}function air_get_search_tweets(b,e,d,c,g,a,f){window.parentSandboxBridge.get_search_tweets(b,e,d,c,g,a,f,function(m,l,h,n){parse_get_tweets_data(b,l,h,n)})}function js_get_panel(d,e,b,c){if(b=="_search"){return js_get_search_panel(d,e,b)}var f="";var g="";if(c!=null){if(c.profile_background_image_url!=undefined){f=c.profile_background_image_url}if(c.profile_background_color!=undefined){g=c.profile_background_color}}var a="";a+='<div class="panel twitter_panel" id="panel_'+d+'">';a+='<input type="hidden" class="panel_id" value="'+d+'"/><input type="hidden" class="panel_user_name" value="'+e+'"/>';a+='<input type="hidden" class="panel_background" value="'+f+'" /><input type="hidden" class="panel_background_color" value="'+g+'" />';a+='<input type="hidden" class="panel_type" value="regular_panel"/>';a+='<div class="twitter_inputs"><span class="dm_notify_box"></span><textarea class="tweet_input" name="tweet_input" rows="3" cols="30"></textarea><span class="add_hashtag">Add hashtag: </span><input type="text" class="add_hashtag" value=""/><input type="button" class="tweet_submit" onclick="send_tweet(\''+d+'\')" value="Update"/><span class="length_notify_box" id="chars_left_panel_'+d+'"></span><br class="clear_both"/></div>';a+='<div class="last_update"></div>';a+='<div class="tweet_type_menu"><br class="clear_both"/><div class="tweet_type_button" id="panel_'+d+'_regular" onclick="get_tweets(\''+d+'\',\'regular\',1)">Timeline</div><div class="tweet_type_button" id="panel_'+d+'_replies" onclick="get_tweets(\''+d+'\',\'replies\',1)">Replies</div><div class="tweet_type_button" id="panel_'+d+'_direct" onclick="get_tweets(\''+d+"','direct',1)\">Direct messages</div><br class=\"clear_both\" /></div>";a+='<div class="tweets"></div>';a+='<div class="more_tweets" onclick="get_more_tweets(\''+d+"'); return false;\">Load more tweets...</div>";a+="</div>";a+="";return a}function js_get_search_panel(c,d,b){var a="";a+='<div class="panel twitter_panel" id="panel_'+c+'">';a+='<input type="hidden" class="panel_id" value="'+c+'"/><input type="hidden" class="panel_user_name" value="'+d+'"/><input type="hidden" class="panel_type" value="search_panel"/><input type="hidden" class="panel_background" value="" /><input type="hidden" class="panel_background_color" value="fff" />';a+='<div class="twitter_inputs"></div>';a+='<div class="tweet_type_menu"></div><div class="tweets"></div>';a+='<div class="more_tweets" onclick="get_more_tweets(\''+c+"'); return false;\">Load more tweets...</div>";a+="</div>";a+="";return a}function js_get_search_tweets(b,e,d,h,a,g){var f=get_panel_by_id(b);var c=f.user;since_req="&since_id="+h;if(h=="-1"){since_req=""}if(d!=1){since_req=""}if(AIR){air_get_search_tweets(b,c,e,d,since_req,a,g)}else{$.ajax({url:"http://search.twitter.com/search.json",dataType:"json",cache:false,data:"q="+c+"&page="+d+since_req,success:function(l){parse_get_tweets_data(b,e,d,l)}})}}function js_get_tweets(b,e,d,h,a,g){var f=get_panel_by_id(b);if(e=="replies"){return js_get_search_tweets(b,e,d,h,a,g)}if(f.panel_type=="search_panel"){return js_get_search_tweets(b,e,d,h,a,g)}since_req="&since_id="+h;if(h=="-1"){since_req=""}if(d!=1){since_req=""}var c=f.auth;if(e=="regular"){$.ajax({url:"http://twitter.com/statuses/friends_timeline.json",beforeSend:function(l){l.setRequestHeader("Authorization",c)},dataType:"json",cache:false,data:"page="+d+since_req,success:function(l){parse_get_tweets_data(b,e,d,l)}})}else{if(e=="replies"){$.ajax({url:"http://twitter.com/statuses/replies.json",beforeSend:function(l){l.setRequestHeader("Authorization",c)},dataType:"json",cache:false,data:"page="+d+since_req,success:function(l){parse_get_tweets_data(b,e,d,l)}})}else{if(e=="direct"){$.ajax({url:"http://twitter.com/direct_messages.json",beforeSend:function(l){l.setRequestHeader("Authorization",c)},dataType:"json",cache:false,data:"page="+d+since_req,success:function(l){parse_get_tweets_data(b,e,d,l)}})}else{if(e=="direct_sent"){$.ajax({url:"http://twitter.com/direct_messages/sent.json",beforeSend:function(l){l.setRequestHeader("Authorization",c)},dataType:"json",cache:false,data:"page="+d+since_req,success:function(l){parse_get_tweets_data(b,e,d,l)}})}}}}}function js_toggle_favorite(b,c,a){var e=get_panel_by_id(b);var d=e.auth;alert("http://twitter.com/favorites/create/"+c+".json");if(a){$.ajax({url:"http://twitter.com/favorites/create/"+c+".json",beforeSend:function(f){f.setRequestHeader("Authorization",d)},type:"POST",dataType:"json",cache:false,success:function(f){alert("toggled")},error:function(f,h,g){alert("Favorites don't work yet in the AIR version - sorry!")},})}else{$.ajax({url:"http://twitter.com/favorites/destroy/"+c+".json",beforeSend:function(f){f.setRequestHeader("Authorization",d)},type:"POST",dataType:"json",cache:false,success:function(f){}})}}function js_get_twitter_user_info(b){var a="";$.ajax({async:false,url:"http://twitter.com/users/show/"+b+".json",dataType:"json",type:"GET",success:function(c){a=c},error:function(c,e,d){a=null},});return a}function js_get_user_tweets(b,a){$.ajax({url:"http://twitter.com/statuses/user_timeline/"+b+".json",dataType:"json",type:"GET",success:function(c){display_user_tweets(c,a)},error:function(c,e,d){},})}function js_check_login(a,d){var b=false;var c=make_base_auth(a,d);$.ajax({async:false,url:"http://twitter.com/account/verify_credentials.json",beforeSend:function(e){e.setRequestHeader("Authorization",c)},dataType:"json",cache:false,type:"GET",success:function(e){b=true},error:function(e,g,f){b=false},});return b}function js_send_tweet(b,h,c,f,e){var g=get_panel_by_id(b);var d=g.auth;h=escape(h);var a="&in_reply_to_status_id="+c;if(c==0){a=""}if(!e){$.ajax({url:"http://twitter.com/statuses/update.json",beforeSend:function(l){l.setRequestHeader("Authorization",d)},dataType:"json",cache:false,data:"status="+h+a,type:"POST",success:function(l){get_tweets(b,"regular",1)},error:function(){alert("There was an error sending that tweet!")},})}else{$.ajax({url:"http://twitter.com/direct_messages/new.json",beforeSend:function(l){l.setRequestHeader("Authorization",d)},dataType:"json",cache:false,data:"user="+f+"&text="+h,type:"POST",success:function(l){get_tweets(b,"regular",1)}})}}function js_get_user_tweets(b,a){$.ajax({url:"http://twitter.com/statuses/user_timeline/"+b+".json?count=10",type:"GET",success:function(c){display_user_tweets(c,a)},dataType:"json",})}function js_follow_user(a,c){var d=get_panel_by_id(a);var b=d.auth;$.ajax({url:"http://twitter.com/friendships/create/"+c+".json",type:"GET",success:function(e){alert("You are now following @"+c)},error:function(){alert("There was an error while trying to follow @"+c)},dataType:"json",})}function js_get_shizzow_panel(c,d,b){var a="";a+='<div class="panel twitter_panel" id="panel_'+c+'">';a+='<input type="hidden" class="panel_id" value="'+c+'"/><input type="hidden" class="panel_user_name" value="'+d+'"/><input type="hidden" class="panel_type" value="shizzow_panel"/><input type="hidden" class="panel_background" value="" /><input type="hidden" class="panel_background_color" value="fff" />';a+='<div class="twitter_inputs"><textarea class="tweet_input" name="tweet_input" rows="3" cols="30"></textarea><br/>Location: <select class="shizzow_favorites"></select><br/><input type="button" class="tweet_submit" onclick="send_shout(\''+c+'\')" value="Update"/><span class="length_notify_box" id="chars_left_panel_'+c+'"></span><br class="clear_both"/></div>';a+='<div class="tweet_type_menu"></div><div class="tweets"></div>';a+='<div class="more_tweets" onclick="get_more_tweets(\''+c+"'); return false;\">Load more shouts...</div>";a+="</div>";a+="";return a}function proxy_get_panel(e,c,a,d){var b="";$.post(URL_BASE+"bin/ajax.php",{func:"get_panel",panel_id:e,user:c,pass:a,async:false,},function(f,g){b=f},"html");return b}function proxy_get_search_panel(d,b,a,c){$.post(URL_BASE+"bin/ajax.php",{func:"get_search_panel",panel_id:d,search_term:b,},function(e,f){},"html");return""}function proxy_get_session_panels(){show_loader();$.post(URL_BASE+"bin/ajax.php",{func:"get_session_panels",},function(a){$("#panels").append(a);if(TABBED_PANELS){$("#panels").width(PANEL_WIDTH+20);$("#header_nav_buttons").show()}$("#panels").find(".twitter_panel").each(function(d){if($(this).is(".proxy_panel")){var c=$(this).find(".panel_id");var e=$(this).find(".panel_type").val();var b=$(this).find(".panel_user_name").val();tw_panels[tw_panels.length]=new Data_Panel(c.val(),e,b,"",null);add_new_nav_button(c.val());get_tweets(c.val(),"regular",1);if(!TABBED_PANELS){$("#panels").width($("#panels").width()+PANEL_WIDTH+20)}show_panel(c.val())}});hide_loader()},"html")}function proxy_get_tweets(a,d,c,b,e,f){$.post(URL_BASE+"bin/ajax.php",{func:"get_tweets",panel:a,tweet_type:d,page:c,since:b,location:e,location_search_dist:f,},function(g){parse_get_tweets_data(a,d,c,g)},"json")}function proxy_remove_panel(a){$.post(URL_BASE+"bin/ajax.php",{func:"remove_panel",panel:a,},function(b){},"json")}function proxy_send_tweet(b,g,d,e,a){var f=get_panel_by_id(b);var c="regular";if(f.tweet_type=="direct"){c="direct_sent"}$.post(URL_BASE+"bin/ajax.php",{func:"send_tweet",panel:b,tweet_data:g,reply_to:d,reply_to_name:e,direct_message:a,},function(h){get_tweets(b,c,1)},"json")}function proxy_toggle_favorite(b,c,a){$.post(URL_BASE+"bin/ajax.php",{func:"toggle_favorite",panel:b,tweet_id:c,favorite:a,},function(d){},"json")}function proxy_get_twitter_user_info(b){var a="";$.ajax({async:false,url:URL_BASE+"bin/ajax.php",type:"POST",data:"func=get_twitter_user_info&user="+b,success:function(c){a=c},dataType:"json",});return a}function proxy_check_login(c,a){var b=false;$.ajax({async:false,url:URL_BASE+"bin/ajax.php",type:"POST",data:"func=check_login&user="+c+"&pass="+a,success:function(d){b=d},dataType:"json",});return b}function proxy_get_user_tweets(b,a){$.ajax({url:URL_BASE+"bin/ajax.php",type:"POST",data:"func=get_user_tweets&user="+b,success:function(c){display_user_tweets(c,a)},dataType:"json",})}function proxy_follow_user(a,b){$.post(URL_BASE+"bin/ajax.php",{func:"follow_user",panel:a,user:b,},function(c){alert("You are now following @"+b)},"json")}function proxy_get_shizzow_panel(c,b,a){$.post(URL_BASE+"bin/ajax.php",{func:"get_shizzow_panel",panel_id:c,user:b,pass:a,},function(d,e){},"html");return""}function proxy_get_shizzow_favorites(a){$.post(URL_BASE+"bin/ajax.php",{func:"get_shizzow_favorites",panel:a,},function(b,c){parse_shizzow_favorites(a,b)},"json");return""}function proxy_send_shout(b,c,a){show_loader();$.post(URL_BASE+"bin/ajax.php",{func:"proxy_send_shout",panel:b,shout_text:c,loc:a,},function(d,e){alert(d.results.message);hide_loader()},"json");return""}Date.prototype.setISO8601=function(b){var c="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?";var f=b.match(new RegExp(c));var e=0;var a=new Date(f[1],0,1);if(f[3]){a.setMonth(f[3]-1)}if(f[5]){a.setDate(f[5])}if(f[7]){a.setHours(f[7])}if(f[8]){a.setMinutes(f[8])}if(f[10]){a.setSeconds(f[10])}if(f[12]){a.setMilliseconds(Number("0."+f[12])*1000)}if(f[14]){e=(Number(f[16])*60)+Number(f[17]);e*=((f[15]=="-")?1:-1)}e-=a.getTimezoneOffset();time=(Number(a)+(e*60*1000));this.setTime(Number(time))};function make_base_auth(b,c){var a=b+":"+c;var d=Base64.encode(a);return"Basic "+d}var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var a="";var m,h,f,l,g,e,d;var b=0;c=Base64._utf8_encode(c);while(b<c.length){m=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);l=m>>2;g=((m&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64}else{if(isNaN(f)){d=64}}a=a+this._keyStr.charAt(l)+this._keyStr.charAt(g)+this._keyStr.charAt(e)+this._keyStr.charAt(d)}return a},decode:function(c){var a="";var m,h,f;var l,g,e,d;var b=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<c.length){l=this._keyStr.indexOf(c.charAt(b++));g=this._keyStr.indexOf(c.charAt(b++));e=this._keyStr.indexOf(c.charAt(b++));d=this._keyStr.indexOf(c.charAt(b++));m=(l<<2)|(g>>4);h=((g&15)<<4)|(e>>2);f=((e&3)<<6)|d;a=a+String.fromCharCode(m);if(e!=64){a=a+String.fromCharCode(h)}if(d!=64){a=a+String.fromCharCode(f)}}a=Base64._utf8_decode(a);return a},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},_utf8_decode:function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3}}}return b}};jQuery.cookie=function(b,l,o){if(typeof l!="undefined"){o=o||{};if(l===null){l="";o.expires=-1}var e="";if(o.expires&&(typeof o.expires=="number"||o.expires.toUTCString)){var f;if(typeof o.expires=="number"){f=new Date();f.setTime(f.getTime()+(o.expires*24*60*60*1000))}else{f=o.expires}e="; expires="+f.toUTCString()}var n=o.path?"; path="+(o.path):"";var g=o.domain?"; domain="+(o.domain):"";var a=o.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(l),e,n,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!=""){var m=document.cookie.split(";");for(var h=0;h<m.length;h++){var c=jQuery.trim(m[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}};eval(function(h,b,l,d,g,f){g=function(a){return(a<b?"":g(parseInt(a/b)))+((a=a%b)>35?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){while(l--){f[g(l)]=d[l]||g(l)}d=[function(a){return f[a]}];g=function(){return"\\w+"};l=1}while(l--){if(d[l]){h=h.replace(new RegExp("\\b"+g(l)+"\\b","g"),d[l])}}return h}("(5($){$.19={P:'1.2'};$.u(['j','w'],5(i,d){$.q['O'+d]=5(){p(!3[0])6;g a=d=='j'?'s':'m',e=d=='j'?'D':'C';6 3.B(':y')?3[0]['L'+d]:4(3,d.x())+4(3,'n'+a)+4(3,'n'+e)};$.q['I'+d]=5(b){p(!3[0])6;g c=d=='j'?'s':'m',e=d=='j'?'D':'C';b=$.F({t:Z},b||{});g a=3.B(':y')?3[0]['8'+d]:4(3,d.x())+4(3,'E'+c+'w')+4(3,'E'+e+'w')+4(3,'n'+c)+4(3,'n'+e);6 a+(b.t?(4(3,'t'+c)+4(3,'t'+e)):0)}});$.u(['m','s'],5(i,b){$.q['l'+b]=5(a){p(!3[0])6;6 a!=W?3.u(5(){3==h||3==r?h.V(b=='m'?a:$(h)['U'](),b=='s'?a:$(h)['T']()):3['l'+b]=a}):3[0]==h||3[0]==r?S[(b=='m'?'R':'Q')]||$.N&&r.M['l'+b]||r.A['l'+b]:3[0]['l'+b]}});$.q.F({z:5(){g a=0,f=0,o=3[0],8,9,7,v;p(o){7=3.7();8=3.8();9=7.8();8.f-=4(o,'K');8.k-=4(o,'J');9.f+=4(7,'H');9.k+=4(7,'Y');v={f:8.f-9.f,k:8.k-9.k}}6 v},7:5(){g a=3[0].7;G(a&&(!/^A|10$/i.16(a.15)&&$.14(a,'z')=='13'))a=a.7;6 $(a)}});5 4(a,b){6 12($.11(a.17?a[0]:a,b,18))||0}})(X);",62,72,"|||this|num|function|return|offsetParent|offset|parentOffset|||||borr|top|var|window||Height|left|scroll|Left|padding|elem|if|fn|document|Top|margin|each|results|Width|toLowerCase|visible|position|body|is|Right|Bottom|border|extend|while|borderTopWidth|outer|marginLeft|marginTop|client|documentElement|boxModel|inner|version|pageYOffset|pageXOffset|self|scrollTop|scrollLeft|scrollTo|undefined|jQuery|borderLeftWidth|false|html|curCSS|parseInt|static|css|tagName|test|jquery|true|dimensions".split("|"),0,{}));(function(b){var a=b.scrollTo=function(d,f,e){b(window).scrollTo(d,f,e)};a.defaults={axis:"y",duration:1};a.window=function(d){return b(window).scrollable()};b.fn.scrollable=function(){return this.map(function(){var d=this.parentWindow||this.defaultView,h=this.nodeName=="#document"?d.frameElement||d:this,f=h.contentDocument||(h.contentWindow||h).document,e=h.setInterval;return h.nodeName=="IFRAME"||e&&b.browser.safari?f.body:e?f.documentElement:this})};b.fn.scrollTo=function(f,e,d){if(typeof e=="object"){d=e;e=0}if(typeof d=="function"){d={onAfter:d}}d=b.extend({},a.defaults,d);e=e||d.speed||d.duration;d.queue=d.queue&&d.axis.length>1;if(d.queue){e/=2}d.offset=c(d.offset);d.over=c(d.over);return this.scrollable().each(function(){var h=this,v=b(h),t=f,g,s={},r=v.is("html,body");switch(typeof t){case"number":case"string":if(/^([+-]=)?\d+(px)?$/.test(t)){t=c(t);break}t=b(t,this);case"object":if(t.is||t.style){g=(t=b(t)).offset()}}b.each(d.axis.split(""),function(l,y){var w=y=="x"?"Left":"Top",q=w.toLowerCase(),x="scroll"+w,u=h[x],p=y=="x"?"Width":"Height",o=p.toLowerCase();if(g){s[x]=g[q]+(r?0:u-v.offset()[q]);if(d.margin){s[x]-=parseInt(t.css("margin"+w))||0;s[x]-=parseInt(t.css("border"+w+"Width"))||0}s[x]+=d.offset[q]||0;if(d.over[q]){s[x]+=t[o]()*d.over[q]}}else{s[x]=t[q]}if(/^\d+$/.test(s[x])){s[x]=s[x]<=0?0:Math.min(s[x],m(p))}if(!l&&d.queue){if(u!=s[x]){n(d.onAfterFirst)}delete s[x]}});n(d.onAfter);function n(l){v.animate(s,e,d.easing,l&&function(){l.call(this,f,d)})}function m(l){var p="scroll"+l,o=h.ownerDocument;return r?Math.max(o.documentElement[p],o.body[p]):h[p]}}).end()};function c(d){return typeof d=="object"?d:{top:d,left:d}}})(jQuery);shortcut={all_shortcuts:{},add:function(b,h,d){var g={type:"keydown",propagate:false,disable_in_input:true,target:document,keycode:false};if(!d){d=g}else{for(var a in g){if(typeof d[a]=="undefined"){d[a]=g[a]}}}var f=d.target;if(typeof d.target=="string"){f=document.getElementById(d.target)}var c=this;b=b.toLowerCase();var e=function(p){p=p||window.event;if(d.disable_in_input){var m;if(p.target){m=p.target}else{if(p.srcElement){m=p.srcElement}}if(m.nodeType==3){m=m.parentNode}if(m.tagName=="INPUT"||m.tagName=="TEXTAREA"){return}}if(p.keyCode){code=p.keyCode}else{if(p.which){code=p.which}}var o=String.fromCharCode(code);if(code==188){o=","}if(code==190){o="."}var t=b.split("+");var s=0;var q={"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"};var n={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123};var r={shift:{wanted:false,pressed:false},ctrl:{wanted:false,pressed:false},alt:{wanted:false,pressed:false},meta:{wanted:false,pressed:false}};if(p.ctrlKey){r.ctrl.pressed=true}if(p.shiftKey){r.shift.pressed=true}if(p.altKey){r.alt.pressed=true}if(p.metaKey){r.meta.pressed=true}for(var l=0;k=t[l],l<t.length;l++){if(k=="ctrl"||k=="control"){s++;r.ctrl.wanted=true}else{if(k=="shift"){s++;r.shift.wanted=true}else{if(k=="alt"){s++;r.alt.wanted=true}else{if(k=="meta"){s++;r.meta.wanted=true}else{if(k.length>1){if(n[k]==code){s++}}else{if(d.keycode){if(d.keycode==code){s++}}else{if(o==k){s++}else{if(q[o]&&p.shiftKey){o=q[o];if(o==k){s++}}}}}}}}}}if(s==t.length&&r.ctrl.pressed==r.ctrl.wanted&&r.shift.pressed==r.shift.wanted&&r.alt.pressed==r.alt.wanted&&r.meta.pressed==r.meta.wanted){h(p);if(!d.propagate){p.cancelBubble=true;p.returnValue=false;if(p.stopPropagation){p.stopPropagation();p.preventDefault()}return false}}};this.all_shortcuts[b]={callback:e,target:f,event:d.type};if(f.addEventListener){f.addEventListener(d.type,e,false)}else{if(f.attachEvent){f.attachEvent("on"+d.type,e)}else{f["on"+d.type]=e}}},remove:function(a){a=a.toLowerCase();var d=this.all_shortcuts[a];delete (this.all_shortcuts[a]);if(!d){return}var b=d.event;var c=d.target;var e=d.callback;if(c.detachEvent){c.detachEvent("on"+b,e)}else{if(c.removeEventListener){c.removeEventListener(b,e,false)}else{c["on"+b]=false}}}};